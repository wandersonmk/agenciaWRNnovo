<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Briefing - Ag√™ncia WRN</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="img/ico.png" type="image/png">
    <link rel="shortcut icon" href="img/ico.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="briefing-container">
        <a href="index.html" class="home-button">
            <i class="fas fa-home"></i>
            <span>Voltar ao In√≠cio</span>
        </a>
        
        <div class="briefing-card">
            <div class="progress-bar">
                <div class="progress"></div>
            </div>
            
            <div class="question-container">
                <div class="question" data-step="1">
                    <h2>Que tipo de projeto voc√™ precisa?</h2>
                    <div class="options">
                        <button class="option-btn" data-value="Site">Site</button>
                        <button class="option-btn" data-value="Aplicativo">Aplicativo</button>
                        <button class="option-btn" data-value="Chatbot com IA">Chatbot com IA</button>
                        <button class="option-btn" data-value="M√∫ltiplos projetos">Ambos</button>
                    </div>
                </div>

                <div class="question hidden" data-step="2" id="site-question">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Qual tipo de site voc√™ precisa?</h2>
                    <div class="options">
                        <button class="option-btn" data-value="Site Institucional">Site Institucional</button>
                        <button class="option-btn" data-value="E-commerce">E-commerce</button>
                        <button class="option-btn" data-value="Portf√≥lio">Portf√≥lio</button>
                        <button class="option-btn" data-value="Blog/Not√≠cias">Blog/Not√≠cias</button>
                        <button class="option-btn" data-value="Landing Page">Landing Page</button>
                        <button class="option-btn" data-value="Site Personalizado">Personalizado</button>
                    </div>
                </div>

                <div class="question hidden" data-step="2" id="app-question">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Qual tipo de aplicativo voc√™ precisa?</h2>
                    <div class="options">
                        <button class="option-btn" data-value="Aplicativo E-commerce">E-commerce</button>
                        <button class="option-btn" data-value="Aplicativo de Delivery">Delivery</button>
                        <button class="option-btn" data-value="Sistema CRM">Sistema CRM</button>
                        <button class="option-btn" data-value="Aplicativo Personalizado">Personalizado</button>
                    </div>
                </div>

                <div class="question hidden" data-step="2" id="chatbot-question">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Qual tipo de chatbot voc√™ precisa?</h2>
                    <div class="options">
                        <button class="option-btn" data-value="Chatbot de Atendimento ao Cliente">Atendimento ao Cliente</button>
                        <button class="option-btn" data-value="Chatbot de Vendas e Convers√£o">Vendas e Convers√£o</button>
                        <button class="option-btn" data-value="Chatbot de Suporte T√©cnico">Suporte T√©cnico</button>
                        <button class="option-btn" data-value="Chatbot de Agendamento">Agendamento</button>
                        <button class="option-btn" data-value="Chatbot Personalizado">Personalizado</button>
                    </div>
                </div>

                <div class="question hidden" data-step="2" id="both-question">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Qual combina√ß√£o voc√™ precisa?</h2>
                    <div class="options">
                        <button class="option-btn" data-value="Site + Aplicativo">Site + Aplicativo</button>
                        <button class="option-btn" data-value="Site + Chatbot">Site + Chatbot</button>
                        <button class="option-btn" data-value="Aplicativo + Chatbot">Aplicativo + Chatbot</button>
                        <button class="option-btn" data-value="Site + Aplicativo + Chatbot">Site + App + Chatbot</button>
                    </div>
                </div>

                <div class="question hidden" data-step="3">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Quando voc√™ pretende iniciar o projeto?</h2>
                    <div class="options">
                        <button class="option-btn" data-value="Imediatamente">Imediatamente</button>
                        <button class="option-btn" data-value="Em 15 dias">Em 15 dias</button>
                        <button class="option-btn" data-value="Em 30 dias">Em 30 dias</button>
                        <button class="option-btn" data-value="Em 60 dias ou mais">Em 60 dias ou mais</button>
                    </div>
                </div>

                <div class="question hidden" data-step="4">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Qual √© o nome da sua empresa?</h2>
                    <input type="text" class="text-input" id="companyName" placeholder="Digite o nome da sua empresa">
                    <button class="next-btn" onclick="handleTextInput(this)">Continuar</button>
                </div>

                <div class="question hidden" data-step="5">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Qual √© o seu cargo na empresa?</h2>
                    <input type="text" class="text-input" id="role" placeholder="Digite seu cargo">
                    <button class="next-btn" onclick="handleTextInput(this)">Continuar</button>
                </div>

                <div class="question hidden" data-step="6">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Como podemos te chamar?</h2>
                    <input type="text" class="text-input" id="name" placeholder="Digite seu nome">
                    <button class="next-btn" onclick="handleTextInput(this)">Continuar</button>
                </div>

                <div class="question hidden" data-step="7">
                    <button class="back-btn" onclick="previousStep()">
                        <i class="fas fa-arrow-left"></i>
                        Voltar
                    </button>
                    <h2>Qual √© o seu WhatsApp?</h2>
                    <input type="tel" class="text-input" id="phone" placeholder="(00) 00000-0000">
                    <button class="next-btn" onclick="handleTextInput(this)">Continuar</button>
                </div>

                <div class="question hidden thank-you" data-step="8">
                    <div class="success-animation">
                        <div class="success-circle">
                            <i class="fas fa-check"></i>
                        </div>
                    </div>
                    <h2>üéâ Briefing Enviado com Sucesso!</h2>
                    <div class="success-message">
                        <p><strong>Obrigado pelo seu interesse!</strong></p>
                        <p>‚úÖ Recebemos todas as informa√ß√µes do seu projeto</p>
                        <p>üìû <strong>Nossa equipe entrar√° em contato em breve</strong></p>
                        <p>‚è∞ Tempo estimado de resposta: <strong>at√© 24 horas</strong></p>
                        <p style="font-size: 0.9em; color: #666; margin-top: 10px;">
                            üìÖ <em>De segunda a sexta-feira. Nos finais de semana o tempo de resposta pode ser maior.</em>
                        </p>
                    </div>
                    <div class="success-actions">
                        <a href="index.html" class="home-link primary">Voltar ao In√≠cio</a>
                        <a href="https://api.whatsapp.com/send/?phone=5511914600243&text=Ol√°! Acabei de enviar um briefing pelo site e gostaria de acelerar o contato." target="_blank" class="whatsapp-link">
                            <i class="fab fa-whatsapp"></i>
                            Falar no WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const formData = {};
        let currentStep = 1;
        const totalSteps = 7;

        async function getClientIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.log('N√£o foi poss√≠vel obter o IP:', error);
                return 'N/A';
            }
        }

        async function sendFormData(data) {
            try {
                const response = await fetch('https://n8n-n8n-start.lfuji0.easypanel.host/webhook/dados', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        tipoProjeto: data.step1,
                        tipoDetalhado: data.step2,
                        prazoInicio: data.step3,
                        empresa: data.step4,
                        cargo: data.step5,
                        nome: data.step6,
                        whatsapp: data.step7,
                        dataEnvio: new Date().toISOString(),
                        ip: await getClientIP(),
                        userAgent: navigator.userAgent
                    })
                });

                if (!response.ok) {
                    throw new Error('Erro ao enviar dados');
                }

                console.log('Dados enviados com sucesso!');
                return true;
            } catch (error) {
                console.error('Erro ao enviar dados:', error);
                return false;
            }
        }

        function updateProgress() {
            const progress = (currentStep - 1) / (totalSteps - 1) * 100;
            document.querySelector('.progress').style.width = `${progress}%`;
        }

        function showQuestion(step) {
            document.querySelectorAll('.question').forEach(q => q.classList.add('hidden'));
            
            if (step === 2) {
                // No step 2, mostra a pergunta correta baseada na escolha do step 1
                const projectType = formData.step1;
                if (projectType === 'Site') {
                    document.getElementById('site-question').classList.remove('hidden');
                } else if (projectType === 'Aplicativo') {
                    document.getElementById('app-question').classList.remove('hidden');
                } else if (projectType === 'Chatbot com IA') {
                    document.getElementById('chatbot-question').classList.remove('hidden');
                } else if (projectType === 'M√∫ltiplos projetos') {
                    document.getElementById('both-question').classList.remove('hidden');
                }
            } else {
                document.querySelector(`[data-step="${step}"]`).classList.remove('hidden');
            }
            
            if (step <= totalSteps) {
                updateProgress();
            }
        }

        function formatPhone(value) {
            value = value.replace(/\D/g, '');
            if (value.length > 11) value = value.slice(0, 11);
            
            if (value.length > 2) {
                value = `(${value.slice(0, 2)}) ${value.slice(2)}`;
            }
            if (value.length > 9) {
                value = `${value.slice(0, 10)}-${value.slice(10)}`;
            }
            return value;
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                showQuestion(currentStep);
            }
        }

        async function nextStep(value) {
            formData[`step${currentStep}`] = value;
            
            if (currentStep === totalSteps) {
                // Tentar enviar os dados
                const sent = await sendFormData(formData);
                
                if (sent) {
                    // Se enviou com sucesso, mostrar tela de agradecimento
                    currentStep++;
                    showQuestion(8);
                } else {
                    alert('Ops! Houve um erro ao enviar o briefing. Por favor, tente novamente.');
                }
            } else {
                currentStep++;
                showQuestion(currentStep);
            }
        }

        function handleTextInput(button) {
            const input = button.previousElementSibling;
            if (input.value.trim()) {
                nextStep(input.value.trim());
            }
        }

        // Event Listeners para bot√µes de op√ß√£o
        document.querySelectorAll('.option-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const value = e.target.dataset.value;
                nextStep(value);
            });
        });

        // Permitir Enter nos campos de texto
        document.querySelectorAll('.text-input').forEach(input => {
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && input.value.trim()) {
                    nextStep(input.value.trim());
                }
            });

            // Adicionar evento de input para validar enquanto digita
            input.addEventListener('input', (e) => {
                const nextButton = e.target.nextElementSibling;
                if (e.target.value.trim()) {
                    nextButton.removeAttribute('disabled');
                } else {
                    nextButton.setAttribute('disabled', 'true');
                }
            });
        });

        // M√°scara para o campo de telefone
        document.getElementById('phone').addEventListener('input', (e) => {
            e.target.value = formatPhone(e.target.value);
        });

        showQuestion(1);
    </script>
</body>
</html>
